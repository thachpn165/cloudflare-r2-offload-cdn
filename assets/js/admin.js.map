{"version":3,"file":"admin.js","sources":["../src/js/admin.js"],"sourcesContent":["/**\n * Admin JavaScript for CloudFlare R2 Offload & CDN\n */\n\nimport '../scss/admin.scss';\n\n(function ($) {\n  'use strict';\n\n  const CFR2OffLoadAdmin = {\n    /**\n     * Initialize the admin module.\n     */\n    init() {\n      this.cacheElements();\n      this.bindEvents();\n      // Hide save button on Dashboard tab and Bulk Actions tab.\n      $('.cloudflare-r2-offload-cdn-form-actions').hide();\n      this.progressInterval = null;\n      this.activityLogInterval = null;\n      this.bulkStartTime = null;\n      this.bulkStats = { completed: 0, failed: 0, total: 0 };\n      this.isProcessing = false;\n      this.currentAction = 'offload'; // 'offload' or 'restore'\n    },\n\n    /**\n     * Cache DOM elements.\n     */\n    cacheElements() {\n      this.$tabs = $('.cloudflare-r2-offload-cdn-tabs li');\n      this.$tabContents = $('.cloudflare-r2-offload-cdn-tab-content');\n      this.$form = $('#cloudflare-r2-offload-cdn-settings-form');\n      this.$saveBtn = $('.cloudflare-r2-offload-cdn-save-btn');\n      this.$toast = $('#cloudflare-r2-offload-cdn-toast');\n    },\n\n    /**\n     * Bind event handlers.\n     */\n    bindEvents() {\n      this.$tabs.on('click', this.handleTabClick.bind(this));\n      this.$form.on('submit', this.handleFormSubmit.bind(this));\n      $(document).on('click', '.cloudflare-r2-offload-cdn-accordion-header', this.handleAccordionClick);\n      $('#test-r2-connection').on('click', this.handleTestR2Connection.bind(this));\n      $('#cfr2-bulk-offload-all').on('click', this.handleBulkOffload.bind(this));\n      $('#cfr2-bulk-restore-all').on('click', this.handleBulkRestore.bind(this));\n      $('#cfr2-cancel-bulk').on('click', this.handleCancelBulk.bind(this));\n      $('#cdn_enabled').on('change', this.handleCDNToggle.bind(this));\n      $('#smart_sizes').on('change', this.handleSmartSizesToggle.bind(this));\n      $('#quality').on('input', this.handleQualityChange.bind(this));\n      $('#deploy-worker').on('click', this.handleDeployWorker.bind(this));\n      $('#remove-worker').on('click', this.handleRemoveWorker.bind(this));\n      $('#cfr2-retry-all-failed').on('click', this.handleRetryFailed.bind(this));\n      $('#cfr2-retry-all').on('click', this.handleRetryFailed.bind(this));\n      $('#cfr2-clear-log').on('click', this.handleClearLog.bind(this));\n      $(document).on('click', '.cfr2-retry-single', this.handleRetrySingle.bind(this));\n      $('#goto-bulk-actions').on('click', this.handleGotoBulkActions.bind(this));\n\n      // Media attachment detail page offload button.\n      $(document).on('click', '.cfr2-offload-btn', this.handleAttachmentOffload.bind(this));\n\n      // CDN DNS validation.\n      $('#validate-cdn-dns').on('click', this.handleValidateCdnDns.bind(this));\n      $(document).on('click', '.cfr2-enable-proxy-btn', this.handleEnableDnsProxy.bind(this));\n    },\n\n    /**\n     * Handle tab click.\n     *\n     * @param {Event} e Click event.\n     */\n    handleTabClick(e) {\n      const $tab = $(e.currentTarget);\n      const tabId = $tab.data('tab');\n\n      // Update active tab.\n      this.$tabs.removeClass('active');\n      $tab.addClass('active');\n\n      // Show corresponding content.\n      this.$tabContents.removeClass('active');\n      $('#tab-' + tabId).addClass('active');\n\n      // Hide save button on Dashboard tab and Bulk Actions tab.\n      $('.cloudflare-r2-offload-cdn-form-actions').toggle(tabId !== 'dashboard' && tabId !== 'bulk-actions');\n\n      // Load activity log if on bulk actions tab.\n      if (tabId === 'bulk-actions') {\n        this.loadActivityLog();\n        this.checkBulkProgress();\n      }\n    },\n\n    /**\n     * Handle accordion header click.\n     *\n     * @param {Event} e Click event.\n     */\n    handleAccordionClick(e) {\n      const $header = $(e.currentTarget);\n      const $content = $header.next('.cloudflare-r2-offload-cdn-accordion-content');\n\n      $header.toggleClass('active');\n      $content.toggleClass('active');\n    },\n\n    /**\n     * Handle form submit (AJAX save).\n     *\n     * @param {Event} e Submit event.\n     */\n    handleFormSubmit(e) {\n      e.preventDefault();\n\n      if (this.$saveBtn.hasClass('is-loading')) {\n        return;\n      }\n\n      this.setLoading(true);\n\n      const formData = this.$form.serialize();\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: formData + '&action=cloudflare_r2_offload_cdn_save_settings',\n        success: this.handleSaveSuccess.bind(this),\n        error: this.handleSaveError.bind(this),\n        complete: () => this.setLoading(false),\n      });\n    },\n\n    /**\n     * Handle successful save.\n     *\n     * @param {Object} response AJAX response.\n     */\n    handleSaveSuccess(response) {\n      if (response.success) {\n        this.showToast(response.data.message, 'success');\n      } else {\n        this.showToast(response.data.message || myPluginAdmin.strings.error, 'error');\n      }\n    },\n\n    /**\n     * Handle save error.\n     */\n    handleSaveError() {\n      this.showToast(myPluginAdmin.strings.error, 'error');\n    },\n\n    /**\n     * Set loading state.\n     *\n     * @param {boolean} isLoading Loading state.\n     */\n    setLoading(isLoading) {\n      this.$saveBtn.toggleClass('is-loading', isLoading);\n    },\n\n    /**\n     * Show toast notification.\n     *\n     * @param {string} message Toast message.\n     * @param {string} type    Toast type (success|error).\n     */\n    showToast(message, type = 'success') {\n      const icon = type === 'success' ? 'yes-alt' : 'warning';\n      const $toast = $('<div>', { class: `cloudflare-r2-offload-cdn-toast-item ${type}` }).append(\n        $('<span>', { class: `dashicons dashicons-${icon}` }),\n        $('<span>').text(message) // Use .text() to prevent XSS\n      );\n\n      this.$toast.append($toast);\n\n      // Auto-remove after 3 seconds.\n      setTimeout(() => {\n        $toast.addClass('fade-out');\n        setTimeout(() => $toast.remove(), 300);\n      }, 3000);\n    },\n\n    /**\n     * Handle R2 connection test.\n     *\n     * @param {Event} e Click event.\n     */\n    handleTestR2Connection(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#r2-connection-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cloudflare_r2_offload_cdn_test_r2',\n          cloudflare_r2_offload_cdn_nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          r2_account_id: $('#r2_account_id').val(),\n          r2_access_key_id: $('#r2_access_key_id').val(),\n          r2_secret_access_key: $('#r2_secret_access_key').val(),\n          r2_bucket: $('#r2_bucket').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Connection failed</span>');\n          this.showToast('Connection test failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Handle bulk offload.\n     *\n     * @param {Event} e Click event.\n     */\n    handleBulkOffload(e) {\n      e.preventDefault();\n\n      if (!confirm('Queue all media files for offload to R2?')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      $btn.prop('disabled', true).text('Queuing...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_bulk_offload_all',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('info', `Queued ${response.data.total} files for offload.`);\n            this.bulkStats = { completed: 0, failed: 0, total: response.data.total };\n            this.startBulkProcessing();\n          } else {\n            this.terminalLog('error', response.data.message);\n            this.showToast(response.data.message, 'error');\n            $btn.prop('disabled', false).text('Offload All Media');\n          }\n        },\n        error: () => {\n          this.terminalLog('error', 'Failed to queue files.');\n          this.showToast('Failed to start bulk offload', 'error');\n          $btn.prop('disabled', false).text('Offload All Media');\n        },\n      });\n    },\n\n    /**\n     * Handle bulk restore.\n     *\n     * @param {Event} e Click event.\n     */\n    handleBulkRestore(e) {\n      e.preventDefault();\n\n      if (!confirm('Restore all media files from R2 to local?')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      $btn.prop('disabled', true).text('Queuing...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_bulk_restore_all',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('info', `Queued ${response.data.total} files for restore.`);\n            this.bulkStats = { completed: 0, failed: 0, total: response.data.total };\n            this.currentAction = 'restore';\n            this.startBulkProcessing();\n          } else {\n            this.terminalLog('error', response.data.message);\n            this.showToast(response.data.message, 'error');\n            $btn.prop('disabled', false).text($btn.data('original-text') || 'Restore All');\n          }\n        },\n        error: () => {\n          this.terminalLog('error', 'Failed to queue files for restore.');\n          this.showToast('Failed to start bulk restore', 'error');\n          $btn.prop('disabled', false).text($btn.data('original-text') || 'Restore All');\n        },\n      });\n    },\n\n    /**\n     * Handle cancel bulk.\n     *\n     * @param {Event} e Click event.\n     */\n    handleCancelBulk(e) {\n      e.preventDefault();\n\n      if (!confirm('Cancel bulk operation?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_cancel_bulk',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('warning', 'Bulk operation cancelled by user.');\n            this.showToast(response.data.message, 'success');\n            this.stopBulkProcessing();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to cancel bulk operation', 'error');\n        },\n      });\n    },\n\n    /**\n     * Start bulk processing via AJAX.\n     */\n    startBulkProcessing() {\n      this.isProcessing = true;\n      this.bulkStartTime = Date.now();\n\n      $('#cfr2-bulk-offload-all').hide();\n      $('#cfr2-bulk-restore-all').hide();\n      $('#cfr2-retry-all-failed').hide();\n      $('#cfr2-cancel-bulk').show();\n      $('#cfr2-bulk-progress-section').show();\n\n      const actionText = this.currentAction === 'restore' ? 'restore' : 'offload';\n      this.terminalLog('info', `Starting ${actionText} process...`);\n      this.updateProgressDisplay();\n\n      // Start processing loop.\n      this.processNextItem();\n\n      // Update elapsed time every second.\n      this.progressInterval = setInterval(() => {\n        this.updateElapsedTime();\n      }, 1000);\n    },\n\n    /**\n     * Stop bulk processing.\n     */\n    stopBulkProcessing() {\n      this.isProcessing = false;\n\n      if (this.progressInterval) {\n        clearInterval(this.progressInterval);\n        this.progressInterval = null;\n      }\n\n      $('#cfr2-bulk-offload-all').show().prop('disabled', false);\n      $('#cfr2-bulk-restore-all').show().prop('disabled', false);\n      $('#cfr2-retry-all-failed').show();\n      $('#cfr2-cancel-bulk').hide();\n\n      this.bulkStartTime = null;\n      this.currentAction = 'offload'; // Reset to default.\n\n      // Refresh page to update counts after bulk operation.\n      setTimeout(() => location.reload(), 1500);\n    },\n\n    /**\n     * Process next item in queue via AJAX.\n     */\n    processNextItem() {\n      if (!this.isProcessing) {\n        return;\n      }\n\n      const ajaxAction = this.currentAction === 'restore' ? 'cfr2_process_restore_item' : 'cfr2_process_bulk_item';\n      const actionText = this.currentAction === 'restore' ? 'restore' : 'offload';\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: ajaxAction,\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            const data = response.data;\n\n            if (data.done) {\n              // All done or cancelled.\n              this.terminalLog('info', data.message);\n              this.terminalLog('info', `Completed: ${this.bulkStats.completed} | Failed: ${this.bulkStats.failed}`);\n              this.showToast(`Bulk ${actionText} completed`, 'success');\n              this.stopBulkProcessing();\n              return;\n            }\n\n            // Log the result.\n            const logType = data.status === 'success' ? 'success' : 'error';\n            this.terminalLog(logType, `${data.filename} - ${data.message}`);\n\n            // Update stats.\n            if (data.status === 'success') {\n              this.bulkStats.completed++;\n            } else {\n              this.bulkStats.failed++;\n            }\n\n            this.updateProgressDisplay();\n\n            // Process next item immediately.\n            this.processNextItem();\n          } else {\n            this.terminalLog('error', response.data.message || 'Unknown error');\n            this.stopBulkProcessing();\n          }\n        },\n        error: () => {\n          this.terminalLog('error', 'Network error. Retrying in 3 seconds...');\n          // Retry after delay.\n          setTimeout(() => this.processNextItem(), 3000);\n        },\n      });\n    },\n\n    /**\n     * Update progress display.\n     */\n    updateProgressDisplay() {\n      const { completed, failed, total } = this.bulkStats;\n      const processed = completed + failed;\n      const percentage = total > 0 ? Math.round((processed / total) * 100) : 0;\n\n      $('.cfr2-progress-fill').css('width', percentage + '%');\n      $('.cfr2-progress-percentage').text(percentage + '%');\n      $('.cfr2-progress-text').html(\n        `<span style=\"color: #46b450;\">✓ ${completed}</span> | ` +\n        `<span style=\"color: #dc3232;\">✗ ${failed}</span> | ` +\n        `<span style=\"color: #646970;\">○ ${total - processed} remaining</span>`\n      );\n    },\n\n    /**\n     * Update elapsed time display.\n     */\n    updateElapsedTime() {\n      if (this.bulkStartTime) {\n        const elapsed = Math.floor((Date.now() - this.bulkStartTime) / 1000);\n        const minutes = Math.floor(elapsed / 60);\n        const seconds = elapsed % 60;\n        $('#cfr2-elapsed').text(`${minutes}m ${seconds}s`);\n      }\n    },\n\n    /**\n     * Log message to terminal.\n     *\n     * @param {string} type    Log type (info|success|error|warning).\n     * @param {string} message Log message.\n     */\n    terminalLog(type, message) {\n      const $terminal = $('#cfr2-terminal-output');\n      const time = new Date().toLocaleTimeString();\n      const icons = {\n        info: '●',\n        success: '✓',\n        error: '✗',\n        warning: '⚠',\n      };\n\n      const $line = $(`\n        <div class=\"cfr2-terminal-line cfr2-terminal-${type}\">\n          <span class=\"cfr2-terminal-time\">[${time}]</span>\n          <span class=\"cfr2-terminal-icon\">${icons[type] || '●'}</span>\n          <span class=\"cfr2-terminal-message\">${this.escapeHtml(message)}</span>\n        </div>\n      `);\n\n      $terminal.append($line);\n      $terminal.scrollTop($terminal[0].scrollHeight);\n    },\n\n    /**\n     * Escape HTML to prevent XSS.\n     *\n     * @param {string} text Text to escape.\n     * @return {string} Escaped text.\n     */\n    escapeHtml(text) {\n      const div = document.createElement('div');\n      div.textContent = text;\n      return div.innerHTML;\n    },\n\n    /**\n     * Handle CDN toggle.\n     *\n     * @param {Event} e Change event.\n     */\n    handleCDNToggle(e) {\n      const isEnabled = $(e.currentTarget).is(':checked');\n      $('.cdn-fields').toggle(isEnabled);\n    },\n\n    /**\n     * Handle smart sizes toggle.\n     *\n     * @param {Event} e Change event.\n     */\n    handleSmartSizesToggle(e) {\n      const isEnabled = $(e.currentTarget).is(':checked');\n      $('.smart-sizes-options').toggle(isEnabled);\n    },\n\n    /**\n     * Handle quality slider change.\n     *\n     * @param {Event} e Input event.\n     */\n    handleQualityChange(e) {\n      const value = $(e.currentTarget).val();\n      $('#quality-value').text(value);\n    },\n\n    /**\n     * Handle deploy worker.\n     *\n     * @param {Event} e Click event.\n     */\n    handleDeployWorker(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#worker-deploy-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_deploy_worker',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n            $('#remove-worker').show();\n            // Refresh page to update status\n            setTimeout(() => location.reload(), 1500);\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Deployment failed</span>');\n          this.showToast('Worker deployment failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Handle remove worker.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRemoveWorker(e) {\n      e.preventDefault();\n\n      if (!confirm('Remove deployed Worker? This will disable CDN URL rewriting.')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#worker-deploy-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_remove_worker',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n            $btn.hide();\n            // Refresh page to update status\n            setTimeout(() => location.reload(), 1500);\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Remove failed</span>');\n          this.showToast('Worker removal failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Load activity log into terminal.\n     */\n    loadActivityLog() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_activity_log',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          limit: 50,\n        },\n        success: (response) => {\n          if (response.success && response.data.logs.length > 0) {\n            const $terminal = $('#cfr2-terminal-output');\n\n            // Only load if terminal is empty (except initial message).\n            if ($terminal.children().length <= 1) {\n              response.data.logs.reverse().forEach((entry) => {\n                const type = entry.status === 'success' ? 'success' : 'error';\n                const time = new Date(entry.timestamp * 1000).toLocaleTimeString();\n                const icons = { success: '✓', error: '✗' };\n\n                const $line = $(`\n                  <div class=\"cfr2-terminal-line cfr2-terminal-${type}\">\n                    <span class=\"cfr2-terminal-time\">[${time}]</span>\n                    <span class=\"cfr2-terminal-icon\">${icons[type]}</span>\n                    <span class=\"cfr2-terminal-message\">${this.escapeHtml(entry.filename)} - ${this.escapeHtml(entry.message)}</span>\n                  </div>\n                `);\n\n                $terminal.append($line);\n              });\n\n              $terminal.scrollTop($terminal[0].scrollHeight);\n            }\n          }\n        },\n      });\n    },\n\n    /**\n     * Check bulk progress on page load.\n     */\n    checkBulkProgress() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_bulk_progress',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success && response.data.is_running) {\n            // Resume processing if there are pending items.\n            this.terminalLog('info', 'Resuming pending offload...');\n            this.bulkStats = {\n              completed: response.data.completed,\n              failed: response.data.failed,\n              total: response.data.total,\n            };\n            this.startBulkProcessing();\n          }\n        },\n      });\n    },\n\n    /**\n     * Load failed items.\n     */\n    loadFailedItems() {\n      // This would query failed items from queue and display in error summary.\n      // For now, we'll check if there are any failed items via the retry button visibility.\n    },\n\n    /**\n     * Handle retry failed.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRetryFailed(e) {\n      e.preventDefault();\n\n      if (!confirm('Retry all failed items?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_retry_failed',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('info', `Queued ${response.data.queued} items for retry.`);\n            this.bulkStats = { completed: 0, failed: 0, total: response.data.queued };\n            this.startBulkProcessing();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to retry items', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle retry single.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRetrySingle(e) {\n      e.preventDefault();\n\n      const attachmentId = $(e.currentTarget).data('attachment-id');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_retry_single',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          attachment_id: attachmentId,\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            $(e.currentTarget).closest('.cfr2-error-item').fadeOut();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to retry item', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle offload from attachment details page.\n     *\n     * @param {Event} e Click event.\n     */\n    handleAttachmentOffload(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const attachmentId = $btn.data('id');\n      const nonce = $btn.data('nonce');\n      const $status = $btn.siblings('.cfr2-offload-status');\n\n      // Disable button and show loading.\n      $btn.prop('disabled', true).text('Offloading...');\n      $status.html('<span class=\"spinner is-active\" style=\"float: none;\"></span>');\n\n      $.ajax({\n        url: ajaxurl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_offload_attachment',\n          attachment_id: attachmentId,\n          nonce: nonce,\n        },\n        success: (response) => {\n          if (response.success) {\n            $status.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            $btn.hide();\n\n            // Update the status display after a short delay.\n            setTimeout(() => {\n              $btn.closest('td').find('span').first().html(\n                '<span style=\"color: #46b450; font-weight: bold;\">' +\n                '<span class=\"dashicons dashicons-cloud\" style=\"vertical-align: middle;\"></span> ' +\n                'Offloaded to R2</span>' +\n                (response.data.url ? '<br><small style=\"color: #666;\">' + response.data.url + '</small>' : '')\n              );\n              $status.empty();\n            }, 2000);\n          } else {\n            $status.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            $btn.prop('disabled', false).text('Offload to R2');\n          }\n        },\n        error: () => {\n          $status.html('<span style=\"color: #dc3232;\">✗ Request failed</span>');\n          $btn.prop('disabled', false).text('Offload to R2');\n        },\n      });\n    },\n\n    /**\n     * Handle clear log.\n     *\n     * @param {Event} e Click event.\n     */\n    handleClearLog(e) {\n      e.preventDefault();\n\n      if (!confirm('Clear process log?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_clear_log',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            $('#cfr2-terminal-output').html(`\n              <div class=\"cfr2-terminal-line cfr2-terminal-info\">\n                <span class=\"cfr2-terminal-prompt\">$</span>\n                <span>Ready. Click \"Offload All Media\" to start.</span>\n              </div>\n            `);\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to clear log', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle goto bulk actions tab.\n     *\n     * @param {Event} e Click event.\n     */\n    handleGotoBulkActions(e) {\n      e.preventDefault();\n\n      // Trigger tab click.\n      $('.cloudflare-r2-offload-cdn-tabs li[data-tab=\"bulk-actions\"]').trigger('click');\n    },\n\n    /**\n     * Handle CDN DNS validation.\n     *\n     * @param {Event} e Click event.\n     */\n    handleValidateCdnDns(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $status = $('#cdn-dns-status');\n      const cdnUrl = $('#cdn_url').val();\n\n      if (!cdnUrl) {\n        this.showToast('Please enter a CDN URL first', 'error');\n        return;\n      }\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true).text('Validating...');\n      $status.show().html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span> Checking DNS...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_validate_cdn_dns',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          cdn_url: cdnUrl,\n        },\n        success: (response) => {\n          if (response.success) {\n            const data = response.data;\n\n            if (data.action === 'created') {\n              // DNS record was created.\n              $status.html(\n                '<div class=\"cfr2-dns-success\">' +\n                '<span class=\"dashicons dashicons-yes-alt\" style=\"color: #46b450;\"></span> ' +\n                data.message +\n                '</div>'\n              );\n              this.showToast(data.message, 'success');\n            } else if (data.action === 'exists') {\n              // DNS record exists.\n              if (data.warnings && data.warnings.length > 0) {\n                // Has warnings - proxy disabled.\n                $status.html(\n                  '<div class=\"cfr2-dns-warning\">' +\n                  '<span class=\"dashicons dashicons-warning\" style=\"color: #dba617;\"></span> ' +\n                  data.warnings.join('<br>') +\n                  '<br><button type=\"button\" class=\"button cfr2-enable-proxy-btn\" ' +\n                  'data-zone-id=\"' + data.zone_id + '\" data-record-id=\"' + data.record_id + '\">' +\n                  'Enable Proxy Now</button>' +\n                  '</div>'\n                );\n                this.showToast('DNS record found but needs configuration', 'error');\n              } else {\n                // All good.\n                $status.html(\n                  '<div class=\"cfr2-dns-success\">' +\n                  '<span class=\"dashicons dashicons-yes-alt\" style=\"color: #46b450;\"></span> ' +\n                  'DNS record found with proxy enabled. Ready to deploy!' +\n                  '</div>'\n                );\n                this.showToast('DNS validation passed!', 'success');\n              }\n            }\n          } else {\n            $status.html(\n              '<div class=\"cfr2-dns-error\">' +\n              '<span class=\"dashicons dashicons-dismiss\" style=\"color: #dc3232;\"></span> ' +\n              response.data.message +\n              '</div>'\n            );\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $status.html(\n            '<div class=\"cfr2-dns-error\">' +\n            '<span class=\"dashicons dashicons-dismiss\" style=\"color: #dc3232;\"></span> ' +\n            'Validation request failed' +\n            '</div>'\n          );\n          this.showToast('DNS validation failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false).text('Validate DNS');\n        },\n      });\n    },\n\n    /**\n     * Handle enable DNS proxy.\n     *\n     * @param {Event} e Click event.\n     */\n    handleEnableDnsProxy(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const zoneId = $btn.data('zone-id');\n      const recordId = $btn.data('record-id');\n      const $status = $('#cdn-dns-status');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true).text('Enabling...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_enable_dns_proxy',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          zone_id: zoneId,\n          record_id: recordId,\n        },\n        success: (response) => {\n          if (response.success) {\n            $status.html(\n              '<div class=\"cfr2-dns-success\">' +\n              '<span class=\"dashicons dashicons-yes-alt\" style=\"color: #46b450;\"></span> ' +\n              response.data.message + ' Ready to deploy!' +\n              '</div>'\n            );\n            this.showToast(response.data.message, 'success');\n          } else {\n            this.showToast(response.data.message, 'error');\n            $btn.removeClass('is-loading').prop('disabled', false).text('Enable Proxy Now');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to enable proxy', 'error');\n          $btn.removeClass('is-loading').prop('disabled', false).text('Enable Proxy Now');\n        },\n      });\n    },\n  };\n\n  // Initialize when DOM ready.\n  $(document).ready(() => {\n    CFR2OffLoadAdmin.init();\n  });\n})(jQuery);\n"],"names":["$","CFR2OffLoadAdmin","$tab","tabId","$header","$content","formData","response","isLoading","message","type","icon","$toast","$btn","$result","actionText","ajaxAction","data","logType","completed","failed","total","processed","percentage","elapsed","minutes","seconds","$terminal","time","$line","text","div","isEnabled","value","entry","attachmentId","nonce","$status","cdnUrl","zoneId","recordId"],"mappings":"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"}