{"version":3,"file":"admin.js","sources":["../src/js/admin.js"],"sourcesContent":["/**\n * Admin JavaScript for CloudFlare R2 Offload My Plugin CDN\n */\n\nimport '../scss/admin.scss';\n\n(function ($) {\n  'use strict';\n\n  const CFR2OffLoadAdmin = {\n    /**\n     * Initialize the admin module.\n     */\n    init() {\n      this.cacheElements();\n      this.bindEvents();\n      // Hide save button on Dashboard tab and Bulk Actions tab.\n      $('.cloudflare-r2-offload-cdn-form-actions').hide();\n      this.progressInterval = null;\n      this.activityLogInterval = null;\n      this.bulkStartTime = null;\n    },\n\n    /**\n     * Cache DOM elements.\n     */\n    cacheElements() {\n      this.$tabs = $('.cloudflare-r2-offload-cdn-tabs li');\n      this.$tabContents = $('.cloudflare-r2-offload-cdn-tab-content');\n      this.$form = $('#cloudflare-r2-offload-cdn-settings-form');\n      this.$saveBtn = $('.cloudflare-r2-offload-cdn-save-btn');\n      this.$toast = $('#cloudflare-r2-offload-cdn-toast');\n    },\n\n    /**\n     * Bind event handlers.\n     */\n    bindEvents() {\n      this.$tabs.on('click', this.handleTabClick.bind(this));\n      this.$form.on('submit', this.handleFormSubmit.bind(this));\n      $(document).on('click', '.cloudflare-r2-offload-cdn-accordion-header', this.handleAccordionClick);\n      $('#test-r2-connection').on('click', this.handleTestR2Connection.bind(this));\n      $('#cfr2-bulk-offload-all').on('click', this.handleBulkOffload.bind(this));\n      $('#cfr2-cancel-bulk').on('click', this.handleCancelBulk.bind(this));\n      $('#cdn_enabled').on('change', this.handleCDNToggle.bind(this));\n      $('#quality').on('input', this.handleQualityChange.bind(this));\n      $('#deploy-worker').on('click', this.handleDeployWorker.bind(this));\n      $('#remove-worker').on('click', this.handleRemoveWorker.bind(this));\n      $('#cfr2-retry-all-failed').on('click', this.handleRetryFailed.bind(this));\n      $('#cfr2-retry-all').on('click', this.handleRetryFailed.bind(this));\n      $('#cfr2-clear-log').on('click', this.handleClearLog.bind(this));\n      $(document).on('click', '.cfr2-retry-single', this.handleRetrySingle.bind(this));\n      $('#goto-bulk-actions').on('click', this.handleGotoBulkActions.bind(this));\n    },\n\n    /**\n     * Handle tab click.\n     *\n     * @param {Event} e Click event.\n     */\n    handleTabClick(e) {\n      const $tab = $(e.currentTarget);\n      const tabId = $tab.data('tab');\n\n      // Update active tab.\n      this.$tabs.removeClass('active');\n      $tab.addClass('active');\n\n      // Show corresponding content.\n      this.$tabContents.removeClass('active');\n      $('#tab-' + tabId).addClass('active');\n\n      // Hide save button on Dashboard tab and Bulk Actions tab.\n      $('.cloudflare-r2-offload-cdn-form-actions').toggle(tabId !== 'dashboard' && tabId !== 'bulk-actions');\n\n      // Load activity log if on bulk actions tab.\n      if (tabId === 'bulk-actions') {\n        this.loadActivityLog();\n        this.checkBulkProgress();\n      }\n    },\n\n    /**\n     * Handle accordion header click.\n     *\n     * @param {Event} e Click event.\n     */\n    handleAccordionClick(e) {\n      const $header = $(e.currentTarget);\n      const $content = $header.next('.cloudflare-r2-offload-cdn-accordion-content');\n\n      $header.toggleClass('active');\n      $content.toggleClass('active');\n    },\n\n    /**\n     * Handle form submit (AJAX save).\n     *\n     * @param {Event} e Submit event.\n     */\n    handleFormSubmit(e) {\n      e.preventDefault();\n\n      if (this.$saveBtn.hasClass('is-loading')) {\n        return;\n      }\n\n      this.setLoading(true);\n\n      const formData = this.$form.serialize();\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: formData + '&action=cloudflare_r2_offload_cdn_save_settings',\n        success: this.handleSaveSuccess.bind(this),\n        error: this.handleSaveError.bind(this),\n        complete: () => this.setLoading(false),\n      });\n    },\n\n    /**\n     * Handle successful save.\n     *\n     * @param {Object} response AJAX response.\n     */\n    handleSaveSuccess(response) {\n      if (response.success) {\n        this.showToast(response.data.message, 'success');\n      } else {\n        this.showToast(response.data.message || myPluginAdmin.strings.error, 'error');\n      }\n    },\n\n    /**\n     * Handle save error.\n     */\n    handleSaveError() {\n      this.showToast(myPluginAdmin.strings.error, 'error');\n    },\n\n    /**\n     * Set loading state.\n     *\n     * @param {boolean} isLoading Loading state.\n     */\n    setLoading(isLoading) {\n      this.$saveBtn.toggleClass('is-loading', isLoading);\n    },\n\n    /**\n     * Show toast notification.\n     *\n     * @param {string} message Toast message.\n     * @param {string} type    Toast type (success|error).\n     */\n    showToast(message, type = 'success') {\n      const icon = type === 'success' ? 'yes-alt' : 'warning';\n      const $toast = $('<div>', { class: `cloudflare-r2-offload-cdn-toast-item ${type}` }).append(\n        $('<span>', { class: `dashicons dashicons-${icon}` }),\n        $('<span>').text(message) // Use .text() to prevent XSS\n      );\n\n      this.$toast.append($toast);\n\n      // Auto-remove after 3 seconds.\n      setTimeout(() => {\n        $toast.addClass('fade-out');\n        setTimeout(() => $toast.remove(), 300);\n      }, 3000);\n    },\n\n    /**\n     * Handle R2 connection test.\n     *\n     * @param {Event} e Click event.\n     */\n    handleTestR2Connection(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#r2-connection-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cloudflare_r2_offload_cdn_test_r2',\n          cloudflare_r2_offload_cdn_nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Connection failed</span>');\n          this.showToast('Connection test failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Handle bulk offload.\n     *\n     * @param {Event} e Click event.\n     */\n    handleBulkOffload(e) {\n      e.preventDefault();\n\n      if (!confirm('Queue all media files for offload to R2?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_bulk_offload_all',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            this.startProgressPolling();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to start bulk offload', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle cancel bulk.\n     *\n     * @param {Event} e Click event.\n     */\n    handleCancelBulk(e) {\n      e.preventDefault();\n\n      if (!confirm('Cancel bulk offload?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_cancel_bulk',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            this.stopProgressPolling();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to cancel bulk offload', 'error');\n        },\n      });\n    },\n\n    /**\n     * Start progress polling.\n     */\n    startProgressPolling() {\n      $('#cfr2-bulk-offload-all').hide();\n      $('#cfr2-retry-all-failed').hide();\n      $('#cfr2-cancel-bulk').show();\n      $('#cfr2-bulk-progress-section').show();\n\n      this.bulkStartTime = Date.now();\n\n      this.progressInterval = setInterval(() => {\n        this.updateProgress();\n      }, 2000);\n\n      // Start activity log polling.\n      this.activityLogInterval = setInterval(() => {\n        this.loadActivityLog();\n      }, 3000);\n\n      this.updateProgress();\n      this.loadActivityLog();\n    },\n\n    /**\n     * Stop progress polling.\n     */\n    stopProgressPolling() {\n      if (this.progressInterval) {\n        clearInterval(this.progressInterval);\n        this.progressInterval = null;\n      }\n\n      if (this.activityLogInterval) {\n        clearInterval(this.activityLogInterval);\n        this.activityLogInterval = null;\n      }\n\n      $('#cfr2-bulk-offload-all').show();\n      $('#cfr2-retry-all-failed').show();\n      $('#cfr2-cancel-bulk').hide();\n      $('#cfr2-bulk-progress-section').hide();\n\n      this.bulkStartTime = null;\n    },\n\n    /**\n     * Update progress.\n     */\n    updateProgress() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_bulk_progress',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            const data = response.data;\n            const percentage = data.total > 0 ? Math.round(((data.completed + data.failed) / data.total) * 100) : 0;\n\n            $('.cfr2-progress-fill').css('width', percentage + '%');\n            $('.cfr2-progress-percentage').text(percentage + '%');\n            $('.cfr2-progress-text').html(\n              `<span style=\"color: #46b450;\">✓ ${data.completed} completed</span> | ` +\n              `<span style=\"color: #dc3232;\">✗ ${data.failed} failed</span> | ` +\n              `<span style=\"color: #646970;\">○ ${data.pending + data.processing} remaining</span>`\n            );\n\n            // Update current file.\n            if (data.current_file) {\n              $('#cfr2-current-file').text(data.current_file);\n            } else {\n              $('#cfr2-current-file').text('—');\n            }\n\n            // Update elapsed time.\n            if (this.bulkStartTime) {\n              const elapsed = Math.floor((Date.now() - this.bulkStartTime) / 1000);\n              const minutes = Math.floor(elapsed / 60);\n              const seconds = elapsed % 60;\n              $('#cfr2-elapsed').text(`${minutes}m ${seconds}s`);\n            }\n\n            if (!data.is_running) {\n              this.stopProgressPolling();\n              this.showToast('Bulk offload completed', 'success');\n              this.loadActivityLog();\n              this.loadFailedItems();\n            }\n          }\n        },\n      });\n    },\n\n    /**\n     * Handle CDN toggle.\n     *\n     * @param {Event} e Change event.\n     */\n    handleCDNToggle(e) {\n      const isEnabled = $(e.currentTarget).is(':checked');\n      $('.cdn-fields').toggle(isEnabled);\n    },\n\n    /**\n     * Handle quality slider change.\n     *\n     * @param {Event} e Input event.\n     */\n    handleQualityChange(e) {\n      const value = $(e.currentTarget).val();\n      $('#quality-value').text(value);\n    },\n\n    /**\n     * Handle deploy worker.\n     *\n     * @param {Event} e Click event.\n     */\n    handleDeployWorker(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#worker-deploy-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_deploy_worker',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n            $('#remove-worker').show();\n            // Refresh page to update status\n            setTimeout(() => location.reload(), 1500);\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Deployment failed</span>');\n          this.showToast('Worker deployment failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Handle remove worker.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRemoveWorker(e) {\n      e.preventDefault();\n\n      if (!confirm('Remove deployed Worker? This will disable CDN URL rewriting.')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#worker-deploy-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_remove_worker',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n            $btn.hide();\n            // Refresh page to update status\n            setTimeout(() => location.reload(), 1500);\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Remove failed</span>');\n          this.showToast('Worker removal failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Load activity log.\n     */\n    loadActivityLog() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_activity_log',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          limit: 20,\n        },\n        success: (response) => {\n          if (response.success && response.data.logs.length > 0) {\n            const $log = $('#cfr2-activity-log');\n            $log.empty();\n\n            response.data.logs.forEach((entry) => {\n              const statusIcon = entry.status === 'success' ? '✓' : '✗';\n              const statusColor = entry.status === 'success' ? '#46b450' : '#dc3232';\n              const time = new Date(entry.timestamp * 1000).toLocaleTimeString();\n\n              const $entry = $(`<div class=\"cfr2-log-entry cfr2-log-${entry.status}\">\n                <span class=\"cfr2-log-time\">${time}</span>\n                <span class=\"cfr2-log-status\" style=\"color: ${statusColor};\">${statusIcon}</span>\n                <span class=\"cfr2-log-filename\">${entry.filename}</span>\n                <span class=\"cfr2-log-message\">${entry.message}</span>\n              </div>`);\n\n              $log.append($entry);\n            });\n\n            // Auto-scroll to bottom.\n            $log.scrollTop($log[0].scrollHeight);\n          }\n        },\n      });\n    },\n\n    /**\n     * Check bulk progress on page load.\n     */\n    checkBulkProgress() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_bulk_progress',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success && response.data.is_running) {\n            this.startProgressPolling();\n          }\n        },\n      });\n    },\n\n    /**\n     * Load failed items.\n     */\n    loadFailedItems() {\n      // This would query failed items from queue and display in error summary.\n      // For now, we'll check if there are any failed items via the retry button visibility.\n    },\n\n    /**\n     * Handle retry failed.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRetryFailed(e) {\n      e.preventDefault();\n\n      if (!confirm('Retry all failed items?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_retry_failed',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            this.startProgressPolling();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to retry items', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle retry single.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRetrySingle(e) {\n      e.preventDefault();\n\n      const attachmentId = $(e.currentTarget).data('attachment-id');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_retry_single',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          attachment_id: attachmentId,\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            $(e.currentTarget).closest('.cfr2-error-item').fadeOut();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to retry item', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle clear log.\n     *\n     * @param {Event} e Click event.\n     */\n    handleClearLog(e) {\n      e.preventDefault();\n\n      if (!confirm('Clear activity log?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_clear_log',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            $('#cfr2-activity-log').html('<p class=\"cfr2-no-data\">No recent activity.</p>');\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to clear log', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle goto bulk actions tab.\n     *\n     * @param {Event} e Click event.\n     */\n    handleGotoBulkActions(e) {\n      e.preventDefault();\n\n      // Trigger tab click.\n      $('.cloudflare-r2-offload-cdn-tabs li[data-tab=\"bulk-actions\"]').trigger('click');\n    },\n  };\n\n  // Initialize when DOM ready.\n  $(document).ready(() => {\n    CFR2OffLoadAdmin.init();\n  });\n})(jQuery);\n"],"names":["$","CFR2OffLoadAdmin","e","$tab","tabId","$header","$content","formData","response","isLoading","message","type","icon","$toast","$btn","$result","data","percentage","elapsed","minutes","seconds","isEnabled","value","$log","entry","statusIcon","statusColor","time","$entry","attachmentId"],"mappings":"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"}