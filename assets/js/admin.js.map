{"version":3,"file":"admin.js","sources":["../src/js/admin.js"],"sourcesContent":["/**\n * Admin JavaScript for CloudFlare R2 Offload & CDN\n */\n\nimport '../scss/admin.scss';\n\n(function ($) {\n  'use strict';\n\n  const CFR2OffLoadAdmin = {\n    /**\n     * Initialize the admin module.\n     */\n    init() {\n      this.cacheElements();\n      this.bindEvents();\n      // Hide save button on Dashboard tab and Bulk Actions tab.\n      $('.cloudflare-r2-offload-cdn-form-actions').hide();\n      this.progressInterval = null;\n      this.activityLogInterval = null;\n      this.bulkStartTime = null;\n      this.bulkStats = { completed: 0, failed: 0, total: 0 };\n      this.isProcessing = false;\n      this.currentAction = 'offload'; // 'offload' or 'restore'\n    },\n\n    /**\n     * Cache DOM elements.\n     */\n    cacheElements() {\n      this.$tabs = $('.cloudflare-r2-offload-cdn-tabs li');\n      this.$tabContents = $('.cloudflare-r2-offload-cdn-tab-content');\n      this.$form = $('#cloudflare-r2-offload-cdn-settings-form');\n      this.$saveBtn = $('.cloudflare-r2-offload-cdn-save-btn');\n      this.$toast = $('#cloudflare-r2-offload-cdn-toast');\n    },\n\n    /**\n     * Bind event handlers.\n     */\n    bindEvents() {\n      this.$tabs.on('click', this.handleTabClick.bind(this));\n      this.$form.on('submit', this.handleFormSubmit.bind(this));\n      $(document).on('click', '.cloudflare-r2-offload-cdn-accordion-header', this.handleAccordionClick);\n      $('#test-r2-connection').on('click', this.handleTestR2Connection.bind(this));\n      $('#cfr2-bulk-offload-all').on('click', this.handleBulkOffload.bind(this));\n      $('#cfr2-bulk-restore-all').on('click', this.handleBulkRestore.bind(this));\n      $('#cfr2-bulk-delete-local').on('click', this.handleBulkDeleteLocal.bind(this));\n      $('#cfr2-cancel-bulk').on('click', this.handleCancelBulk.bind(this));\n      $('#cdn_enabled').on('change', this.handleCDNToggle.bind(this));\n      $('#smart_sizes').on('change', this.handleSmartSizesToggle.bind(this));\n      $('#quality').on('input', this.handleQualityChange.bind(this));\n      $('#deploy-worker').on('click', this.handleDeployWorker.bind(this));\n      $('#remove-worker').on('click', this.handleRemoveWorker.bind(this));\n      $('#cfr2-retry-all-failed').on('click', this.handleRetryFailed.bind(this));\n      $('#cfr2-retry-all').on('click', this.handleRetryFailed.bind(this));\n      $('#cfr2-clear-log').on('click', this.handleClearLog.bind(this));\n      $(document).on('click', '.cfr2-retry-single', this.handleRetrySingle.bind(this));\n      $('#goto-bulk-actions').on('click', this.handleGotoBulkActions.bind(this));\n\n      // Media attachment detail page offload button.\n      $(document).on('click', '.cfr2-offload-btn', this.handleAttachmentOffload.bind(this));\n\n      // CDN DNS validation.\n      $('#validate-cdn-dns').on('click', this.handleValidateCdnDns.bind(this));\n      $(document).on('click', '.cfr2-enable-proxy-btn', this.handleEnableDnsProxy.bind(this));\n\n      // Pending items management.\n      $('#cfr2-pending-stat').on('click', this.handleShowPending.bind(this));\n      $('#cfr2-close-pending').on('click', this.handleClosePending.bind(this));\n      $('#cfr2-clear-pending').on('click', this.handleClearPending.bind(this));\n      $(document).on('click', '.cfr2-cancel-pending-item', this.handleCancelPendingItem.bind(this));\n    },\n\n    /**\n     * Handle tab click.\n     *\n     * @param {Event} e Click event.\n     */\n    handleTabClick(e) {\n      const $tab = $(e.currentTarget);\n      const tabId = $tab.data('tab');\n\n      // Update active tab.\n      this.$tabs.removeClass('active');\n      $tab.addClass('active');\n\n      // Show corresponding content.\n      this.$tabContents.removeClass('active');\n      $('#tab-' + tabId).addClass('active');\n\n      // Hide save button on Dashboard tab and Bulk Actions tab.\n      $('.cloudflare-r2-offload-cdn-form-actions').toggle(tabId !== 'dashboard' && tabId !== 'bulk-actions');\n\n      // Load activity log and refresh counts if on bulk actions tab.\n      if (tabId === 'bulk-actions') {\n        this.loadActivityLog();\n        this.refreshButtonCounts();\n        this.checkBulkProgress();\n      }\n    },\n\n    /**\n     * Handle accordion header click.\n     *\n     * @param {Event} e Click event.\n     */\n    handleAccordionClick(e) {\n      const $header = $(e.currentTarget);\n      const $content = $header.next('.cloudflare-r2-offload-cdn-accordion-content');\n\n      $header.toggleClass('active');\n      $content.toggleClass('active');\n    },\n\n    /**\n     * Handle form submit (AJAX save).\n     *\n     * @param {Event} e Submit event.\n     */\n    handleFormSubmit(e) {\n      e.preventDefault();\n\n      if (this.$saveBtn.hasClass('is-loading')) {\n        return;\n      }\n\n      this.setLoading(true);\n\n      const formData = this.$form.serialize();\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: formData + '&action=cloudflare_r2_offload_cdn_save_settings',\n        success: this.handleSaveSuccess.bind(this),\n        error: this.handleSaveError.bind(this),\n        complete: () => this.setLoading(false),\n      });\n    },\n\n    /**\n     * Handle successful save.\n     *\n     * @param {Object} response AJAX response.\n     */\n    handleSaveSuccess(response) {\n      if (response.success) {\n        this.showToast(response.data.message, 'success');\n      } else {\n        this.showToast(response.data.message || myPluginAdmin.strings.error, 'error');\n      }\n    },\n\n    /**\n     * Handle save error.\n     */\n    handleSaveError() {\n      this.showToast(myPluginAdmin.strings.error, 'error');\n    },\n\n    /**\n     * Set loading state.\n     *\n     * @param {boolean} isLoading Loading state.\n     */\n    setLoading(isLoading) {\n      this.$saveBtn.toggleClass('is-loading', isLoading);\n    },\n\n    /**\n     * Show toast notification.\n     *\n     * @param {string} message Toast message.\n     * @param {string} type    Toast type (success|error).\n     */\n    showToast(message, type = 'success') {\n      const icon = type === 'success' ? 'yes-alt' : 'warning';\n      const $toast = $('<div>', { class: `cloudflare-r2-offload-cdn-toast-item ${type}` }).append(\n        $('<span>', { class: `dashicons dashicons-${icon}` }),\n        $('<span>').text(message) // Use .text() to prevent XSS\n      );\n\n      this.$toast.append($toast);\n\n      // Auto-remove after 3 seconds.\n      setTimeout(() => {\n        $toast.addClass('fade-out');\n        setTimeout(() => $toast.remove(), 300);\n      }, 3000);\n    },\n\n    /**\n     * Handle R2 connection test.\n     *\n     * @param {Event} e Click event.\n     */\n    handleTestR2Connection(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#r2-connection-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cloudflare_r2_offload_cdn_test_r2',\n          cloudflare_r2_offload_cdn_nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          r2_account_id: $('#r2_account_id').val(),\n          r2_access_key_id: $('#r2_access_key_id').val(),\n          r2_secret_access_key: $('#r2_secret_access_key').val(),\n          r2_bucket: $('#r2_bucket').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Connection failed</span>');\n          this.showToast('Connection test failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Handle bulk offload.\n     *\n     * @param {Event} e Click event.\n     */\n    handleBulkOffload(e) {\n      e.preventDefault();\n\n      if (!confirm('Queue all media files for offload to R2?')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      $btn.prop('disabled', true).text('Queuing...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_bulk_offload_all',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('info', `Queued ${response.data.total} files for offload.`);\n            this.bulkStats = { completed: 0, failed: 0, total: response.data.total };\n            this.startBulkProcessing();\n          } else {\n            this.terminalLog('error', response.data.message);\n            this.showToast(response.data.message, 'error');\n            $btn.prop('disabled', false).text('Offload All Media');\n          }\n        },\n        error: () => {\n          this.terminalLog('error', 'Failed to queue files.');\n          this.showToast('Failed to start bulk offload', 'error');\n          $btn.prop('disabled', false).text('Offload All Media');\n        },\n      });\n    },\n\n    /**\n     * Handle bulk restore.\n     *\n     * @param {Event} e Click event.\n     */\n    handleBulkRestore(e) {\n      e.preventDefault();\n\n      if (!confirm('Restore all media files from R2 to local?')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      $btn.prop('disabled', true).text('Queuing...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_bulk_restore_all',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('info', `Queued ${response.data.total} files for restore.`);\n            this.bulkStats = { completed: 0, failed: 0, total: response.data.total };\n            this.currentAction = 'restore';\n            this.startBulkProcessing();\n          } else {\n            this.terminalLog('error', response.data.message);\n            this.showToast(response.data.message, 'error');\n            $btn.prop('disabled', false).text($btn.data('original-text') || 'Restore All');\n          }\n        },\n        error: () => {\n          this.terminalLog('error', 'Failed to queue files for restore.');\n          this.showToast('Failed to start bulk restore', 'error');\n          $btn.prop('disabled', false).text($btn.data('original-text') || 'Restore All');\n        },\n      });\n    },\n\n    /**\n     * Handle bulk delete local (disk saving).\n     *\n     * @param {Event} e Click event.\n     */\n    handleBulkDeleteLocal(e) {\n      e.preventDefault();\n\n      if (!confirm('Delete local files for all offloaded media? Files will remain on R2. This cannot be undone.')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      $btn.prop('disabled', true).text('Queuing...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_bulk_delete_local',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('info', `Queued ${response.data.total} files for local deletion.`);\n            this.bulkStats = { completed: 0, failed: 0, total: response.data.total };\n            this.currentAction = 'delete_local';\n            this.startBulkProcessing();\n          } else {\n            this.terminalLog('error', response.data.message);\n            this.showToast(response.data.message, 'error');\n            $btn.prop('disabled', false).text($btn.data('original-text') || 'Free Disk Space');\n          }\n        },\n        error: () => {\n          this.terminalLog('error', 'Failed to queue files for deletion.');\n          this.showToast('Failed to start bulk delete', 'error');\n          $btn.prop('disabled', false).text($btn.data('original-text') || 'Free Disk Space');\n        },\n      });\n    },\n\n    /**\n     * Handle cancel bulk.\n     *\n     * @param {Event} e Click event.\n     */\n    handleCancelBulk(e) {\n      e.preventDefault();\n\n      if (!confirm('Cancel bulk operation?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_cancel_bulk',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('warning', 'Bulk operation cancelled by user.');\n            this.showToast(response.data.message, 'success');\n            this.stopBulkProcessing();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to cancel bulk operation', 'error');\n        },\n      });\n    },\n\n    /**\n     * Start bulk processing via AJAX.\n     */\n    startBulkProcessing() {\n      this.isProcessing = true;\n      this.bulkStartTime = Date.now();\n\n      $('#cfr2-bulk-offload-all').hide();\n      $('#cfr2-bulk-restore-all').hide();\n      $('#cfr2-bulk-delete-local').hide();\n      $('#cfr2-retry-all-failed').hide();\n      $('#cfr2-cancel-bulk').show();\n      $('#cfr2-bulk-progress-section').show();\n\n      const actionTexts = { offload: 'offload', restore: 'restore', delete_local: 'local file deletion' };\n      const actionText = actionTexts[this.currentAction] || 'offload';\n      this.terminalLog('info', `Starting ${actionText} process...`);\n      this.updateProgressDisplay();\n\n      // Start processing loop.\n      this.processNextItem();\n\n      // Update elapsed time every second.\n      this.progressInterval = setInterval(() => {\n        this.updateElapsedTime();\n      }, 1000);\n    },\n\n    /**\n     * Stop bulk processing.\n     */\n    stopBulkProcessing() {\n      this.isProcessing = false;\n\n      if (this.progressInterval) {\n        clearInterval(this.progressInterval);\n        this.progressInterval = null;\n      }\n\n      $('#cfr2-bulk-offload-all').show().prop('disabled', false);\n      $('#cfr2-bulk-restore-all').show().prop('disabled', false);\n      $('#cfr2-bulk-delete-local').show().prop('disabled', false);\n      $('#cfr2-retry-all-failed').show();\n      $('#cfr2-cancel-bulk').hide();\n\n      this.bulkStartTime = null;\n      this.currentAction = 'offload'; // Reset to default.\n\n      // Refresh button counts via AJAX instead of page reload.\n      this.refreshButtonCounts();\n    },\n\n    /**\n     * Refresh button counts via AJAX.\n     */\n    refreshButtonCounts() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_bulk_counts',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            const data = response.data;\n\n            // Update Offload All button.\n            const $offloadBtn = $('#cfr2-bulk-offload-all');\n            if (data.not_offloaded > 0) {\n              $offloadBtn.show().text(`Offload All Media (${data.not_offloaded})`);\n            } else {\n              $offloadBtn.hide();\n            }\n\n            // Update Restore All button.\n            const $restoreBtn = $('#cfr2-bulk-restore-all');\n            if (data.offloaded > 0) {\n              $restoreBtn.show().text(`Restore All (${data.offloaded})`);\n            } else {\n              $restoreBtn.hide();\n            }\n\n            // Update Free Disk Space button.\n            const $deleteLocalBtn = $('#cfr2-bulk-delete-local');\n            if (data.disk_saveable > 0) {\n              $deleteLocalBtn.show().text(`Free Disk Space (${data.disk_saveable})`);\n            } else {\n              $deleteLocalBtn.hide();\n            }\n          }\n        },\n      });\n    },\n\n    /**\n     * Process next item in queue via AJAX.\n     */\n    processNextItem() {\n      if (!this.isProcessing) {\n        return;\n      }\n\n      const ajaxActions = {\n        offload: 'cfr2_process_bulk_item',\n        restore: 'cfr2_process_restore_item',\n        delete_local: 'cfr2_process_delete_local_item',\n      };\n      const actionTexts = { offload: 'offload', restore: 'restore', delete_local: 'delete local' };\n      const ajaxAction = ajaxActions[this.currentAction] || 'cfr2_process_bulk_item';\n      const actionText = actionTexts[this.currentAction] || 'offload';\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: ajaxAction,\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            const data = response.data;\n\n            if (data.done) {\n              // All done or cancelled.\n              this.terminalLog('info', data.message);\n              this.terminalLog('info', `Completed: ${this.bulkStats.completed} | Failed: ${this.bulkStats.failed}`);\n              this.showToast(`Bulk ${actionText} completed`, 'success');\n              this.stopBulkProcessing();\n              return;\n            }\n\n            // Log the result.\n            const logType = data.status === 'success' ? 'success' : 'error';\n            this.terminalLog(logType, `${data.filename} - ${data.message}`);\n\n            // Update stats.\n            if (data.status === 'success') {\n              this.bulkStats.completed++;\n            } else {\n              this.bulkStats.failed++;\n            }\n\n            this.updateProgressDisplay();\n\n            // Process next item immediately.\n            this.processNextItem();\n          } else {\n            this.terminalLog('error', response.data.message || 'Unknown error');\n            this.stopBulkProcessing();\n          }\n        },\n        error: () => {\n          this.terminalLog('error', 'Network error. Retrying in 3 seconds...');\n          // Retry after delay.\n          setTimeout(() => this.processNextItem(), 3000);\n        },\n      });\n    },\n\n    /**\n     * Update progress display.\n     */\n    updateProgressDisplay() {\n      const { completed, failed, total } = this.bulkStats;\n      const processed = completed + failed;\n      const percentage = total > 0 ? Math.round((processed / total) * 100) : 0;\n\n      $('.cfr2-progress-fill').css('width', percentage + '%');\n      $('.cfr2-progress-percentage').text(percentage + '%');\n      $('.cfr2-progress-text').html(\n        `<span style=\"color: #46b450;\">✓ ${completed}</span> | ` +\n        `<span style=\"color: #dc3232;\">✗ ${failed}</span> | ` +\n        `<span style=\"color: #646970;\">○ ${total - processed} remaining</span>`\n      );\n    },\n\n    /**\n     * Update elapsed time display.\n     */\n    updateElapsedTime() {\n      if (this.bulkStartTime) {\n        const elapsed = Math.floor((Date.now() - this.bulkStartTime) / 1000);\n        const minutes = Math.floor(elapsed / 60);\n        const seconds = elapsed % 60;\n        $('#cfr2-elapsed').text(`${minutes}m ${seconds}s`);\n      }\n    },\n\n    /**\n     * Log message to terminal.\n     *\n     * @param {string} type    Log type (info|success|error|warning).\n     * @param {string} message Log message.\n     */\n    terminalLog(type, message) {\n      const $terminal = $('#cfr2-terminal-output');\n      const time = new Date().toLocaleTimeString();\n      const icons = {\n        info: '●',\n        success: '✓',\n        error: '✗',\n        warning: '⚠',\n      };\n\n      const $line = $(`\n        <div class=\"cfr2-terminal-line cfr2-terminal-${type}\">\n          <span class=\"cfr2-terminal-time\">[${time}]</span>\n          <span class=\"cfr2-terminal-icon\">${icons[type] || '●'}</span>\n          <span class=\"cfr2-terminal-message\">${this.escapeHtml(message)}</span>\n        </div>\n      `);\n\n      $terminal.append($line);\n      $terminal.scrollTop($terminal[0].scrollHeight);\n    },\n\n    /**\n     * Escape HTML to prevent XSS.\n     *\n     * @param {string} text Text to escape.\n     * @return {string} Escaped text.\n     */\n    escapeHtml(text) {\n      const div = document.createElement('div');\n      div.textContent = text;\n      return div.innerHTML;\n    },\n\n    /**\n     * Handle CDN toggle.\n     *\n     * @param {Event} e Change event.\n     */\n    handleCDNToggle(e) {\n      const isEnabled = $(e.currentTarget).is(':checked');\n      $('.cdn-fields').toggle(isEnabled);\n    },\n\n    /**\n     * Handle smart sizes toggle.\n     *\n     * @param {Event} e Change event.\n     */\n    handleSmartSizesToggle(e) {\n      const isEnabled = $(e.currentTarget).is(':checked');\n      $('.smart-sizes-options').toggle(isEnabled);\n    },\n\n    /**\n     * Handle quality slider change.\n     *\n     * @param {Event} e Input event.\n     */\n    handleQualityChange(e) {\n      const value = $(e.currentTarget).val();\n      $('#quality-value').text(value);\n    },\n\n    /**\n     * Handle deploy worker.\n     *\n     * @param {Event} e Click event.\n     */\n    handleDeployWorker(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#worker-deploy-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_deploy_worker',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n            $('#remove-worker').show();\n            // Refresh page to update status\n            setTimeout(() => location.reload(), 1500);\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Deployment failed</span>');\n          this.showToast('Worker deployment failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Handle remove worker.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRemoveWorker(e) {\n      e.preventDefault();\n\n      if (!confirm('Remove deployed Worker? This will disable CDN URL rewriting.')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      const $result = $('#worker-deploy-result');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true);\n      $result.html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_remove_worker',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            $result.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'success');\n            $btn.hide();\n            // Refresh page to update status\n            setTimeout(() => location.reload(), 1500);\n          } else {\n            $result.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $result.html('<span style=\"color: #dc3232;\">✗ Remove failed</span>');\n          this.showToast('Worker removal failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false);\n        },\n      });\n    },\n\n    /**\n     * Load activity log into terminal.\n     */\n    loadActivityLog() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_activity_log',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          limit: 50,\n        },\n        success: (response) => {\n          if (response.success && response.data.logs.length > 0) {\n            const $terminal = $('#cfr2-terminal-output');\n\n            // Only load if terminal is empty (except initial message).\n            if ($terminal.children().length <= 1) {\n              response.data.logs.reverse().forEach((entry) => {\n                const type = entry.status === 'success' ? 'success' : 'error';\n                const time = new Date(entry.timestamp * 1000).toLocaleTimeString();\n                const icons = { success: '✓', error: '✗' };\n\n                const $line = $(`\n                  <div class=\"cfr2-terminal-line cfr2-terminal-${type}\">\n                    <span class=\"cfr2-terminal-time\">[${time}]</span>\n                    <span class=\"cfr2-terminal-icon\">${icons[type]}</span>\n                    <span class=\"cfr2-terminal-message\">${this.escapeHtml(entry.filename)} - ${this.escapeHtml(entry.message)}</span>\n                  </div>\n                `);\n\n                $terminal.append($line);\n              });\n\n              $terminal.scrollTop($terminal[0].scrollHeight);\n            }\n          }\n        },\n      });\n    },\n\n    /**\n     * Check bulk progress on page load.\n     * Note: Auto-resume disabled to prevent issues with stale queue data.\n     * Users should manually click buttons to start operations.\n     */\n    checkBulkProgress() {\n      // Auto-resume disabled - was causing issues with incorrect counts\n      // and infinite loops when queue had items from different action types.\n    },\n\n    /**\n     * Load failed items.\n     */\n    loadFailedItems() {\n      // This would query failed items from queue and display in error summary.\n      // For now, we'll check if there are any failed items via the retry button visibility.\n    },\n\n    /**\n     * Handle retry failed.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRetryFailed(e) {\n      e.preventDefault();\n\n      if (!confirm('Retry all failed items?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_retry_failed',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.terminalLog('info', `Queued ${response.data.queued} items for retry.`);\n            this.bulkStats = { completed: 0, failed: 0, total: response.data.queued };\n            this.startBulkProcessing();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to retry items', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle retry single.\n     *\n     * @param {Event} e Click event.\n     */\n    handleRetrySingle(e) {\n      e.preventDefault();\n\n      const attachmentId = $(e.currentTarget).data('attachment-id');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_retry_single',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          attachment_id: attachmentId,\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            $(e.currentTarget).closest('.cfr2-error-item').fadeOut();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to retry item', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle offload from attachment details page.\n     *\n     * @param {Event} e Click event.\n     */\n    handleAttachmentOffload(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const attachmentId = $btn.data('id');\n      const nonce = $btn.data('nonce');\n      const $status = $btn.siblings('.cfr2-offload-status');\n\n      // Disable button and show loading.\n      $btn.prop('disabled', true).text('Offloading...');\n      $status.html('<span class=\"spinner is-active\" style=\"float: none;\"></span>');\n\n      $.ajax({\n        url: ajaxurl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_offload_attachment',\n          attachment_id: attachmentId,\n          nonce: nonce,\n        },\n        success: (response) => {\n          if (response.success) {\n            $status.html('<span style=\"color: #46b450;\">✓ ' + response.data.message + '</span>');\n            $btn.hide();\n\n            // Update the status display after a short delay.\n            setTimeout(() => {\n              $btn.closest('td').find('span').first().html(\n                '<span style=\"color: #46b450; font-weight: bold;\">' +\n                '<span class=\"dashicons dashicons-cloud\" style=\"vertical-align: middle;\"></span> ' +\n                'Offloaded to R2</span>' +\n                (response.data.url ? '<br><small style=\"color: #666;\">' + response.data.url + '</small>' : '')\n              );\n              $status.empty();\n            }, 2000);\n          } else {\n            $status.html('<span style=\"color: #dc3232;\">✗ ' + response.data.message + '</span>');\n            $btn.prop('disabled', false).text('Offload to R2');\n          }\n        },\n        error: () => {\n          $status.html('<span style=\"color: #dc3232;\">✗ Request failed</span>');\n          $btn.prop('disabled', false).text('Offload to R2');\n        },\n      });\n    },\n\n    /**\n     * Handle clear log.\n     *\n     * @param {Event} e Click event.\n     */\n    handleClearLog(e) {\n      e.preventDefault();\n\n      if (!confirm('Clear process log?')) {\n        return;\n      }\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_clear_log',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            $('#cfr2-terminal-output').html(`\n              <div class=\"cfr2-terminal-line cfr2-terminal-info\">\n                <span class=\"cfr2-terminal-prompt\">$</span>\n                <span>Ready. Click \"Offload All Media\" to start.</span>\n              </div>\n            `);\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to clear log', 'error');\n        },\n      });\n    },\n\n    /**\n     * Handle goto bulk actions tab.\n     *\n     * @param {Event} e Click event.\n     */\n    handleGotoBulkActions(e) {\n      e.preventDefault();\n\n      // Trigger tab click.\n      $('.cloudflare-r2-offload-cdn-tabs li[data-tab=\"bulk-actions\"]').trigger('click');\n    },\n\n    /**\n     * Handle CDN DNS validation.\n     *\n     * @param {Event} e Click event.\n     */\n    handleValidateCdnDns(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const $status = $('#cdn-dns-status');\n      const cdnUrl = $('#cdn_url').val();\n\n      if (!cdnUrl) {\n        this.showToast('Please enter a CDN URL first', 'error');\n        return;\n      }\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true).text('Validating...');\n      $status.show().html('<span class=\"spinner is-active\" style=\"float:none;margin:0 5px;\"></span> Checking DNS...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_validate_cdn_dns',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          cdn_url: cdnUrl,\n        },\n        success: (response) => {\n          if (response.success) {\n            const data = response.data;\n\n            if (data.action === 'created') {\n              // DNS record was created.\n              $status.html(\n                '<div class=\"cfr2-dns-success\">' +\n                '<span class=\"dashicons dashicons-yes-alt\" style=\"color: #46b450;\"></span> ' +\n                data.message +\n                '</div>'\n              );\n              this.showToast(data.message, 'success');\n            } else if (data.action === 'exists') {\n              // DNS record exists.\n              if (data.warnings && data.warnings.length > 0) {\n                // Has warnings - proxy disabled.\n                $status.html(\n                  '<div class=\"cfr2-dns-warning\">' +\n                  '<span class=\"dashicons dashicons-warning\" style=\"color: #dba617;\"></span> ' +\n                  data.warnings.join('<br>') +\n                  '<br><button type=\"button\" class=\"button cfr2-enable-proxy-btn\" ' +\n                  'data-zone-id=\"' + data.zone_id + '\" data-record-id=\"' + data.record_id + '\">' +\n                  'Enable Proxy Now</button>' +\n                  '</div>'\n                );\n                this.showToast('DNS record found but needs configuration', 'error');\n              } else {\n                // All good.\n                $status.html(\n                  '<div class=\"cfr2-dns-success\">' +\n                  '<span class=\"dashicons dashicons-yes-alt\" style=\"color: #46b450;\"></span> ' +\n                  'DNS record found with proxy enabled. Ready to deploy!' +\n                  '</div>'\n                );\n                this.showToast('DNS validation passed!', 'success');\n              }\n            }\n          } else {\n            $status.html(\n              '<div class=\"cfr2-dns-error\">' +\n              '<span class=\"dashicons dashicons-dismiss\" style=\"color: #dc3232;\"></span> ' +\n              response.data.message +\n              '</div>'\n            );\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          $status.html(\n            '<div class=\"cfr2-dns-error\">' +\n            '<span class=\"dashicons dashicons-dismiss\" style=\"color: #dc3232;\"></span> ' +\n            'Validation request failed' +\n            '</div>'\n          );\n          this.showToast('DNS validation failed', 'error');\n        },\n        complete: () => {\n          $btn.removeClass('is-loading').prop('disabled', false).text('Validate DNS');\n        },\n      });\n    },\n\n    /**\n     * Handle enable DNS proxy.\n     *\n     * @param {Event} e Click event.\n     */\n    handleEnableDnsProxy(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const zoneId = $btn.data('zone-id');\n      const recordId = $btn.data('record-id');\n      const $status = $('#cdn-dns-status');\n\n      if ($btn.hasClass('is-loading')) {\n        return;\n      }\n\n      $btn.addClass('is-loading').prop('disabled', true).text('Enabling...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_enable_dns_proxy',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          zone_id: zoneId,\n          record_id: recordId,\n        },\n        success: (response) => {\n          if (response.success) {\n            $status.html(\n              '<div class=\"cfr2-dns-success\">' +\n              '<span class=\"dashicons dashicons-yes-alt\" style=\"color: #46b450;\"></span> ' +\n              response.data.message + ' Ready to deploy!' +\n              '</div>'\n            );\n            this.showToast(response.data.message, 'success');\n          } else {\n            this.showToast(response.data.message, 'error');\n            $btn.removeClass('is-loading').prop('disabled', false).text('Enable Proxy Now');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to enable proxy', 'error');\n          $btn.removeClass('is-loading').prop('disabled', false).text('Enable Proxy Now');\n        },\n      });\n    },\n\n    /**\n     * Handle show pending items.\n     *\n     * @param {Event} e Click event.\n     */\n    handleShowPending(e) {\n      e.preventDefault();\n\n      const $section = $('#cfr2-pending-section');\n      $section.show();\n      this.loadPendingItems();\n    },\n\n    /**\n     * Handle close pending section.\n     *\n     * @param {Event} e Click event.\n     */\n    handleClosePending(e) {\n      e.preventDefault();\n      $('#cfr2-pending-section').hide();\n    },\n\n    /**\n     * Load pending items via AJAX.\n     */\n    loadPendingItems() {\n      const $list = $('#cfr2-pending-list');\n      $list.html('<p class=\"cfr2-loading\">Loading...</p>');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_pending_items',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            const items = response.data.items;\n\n            if (items.length === 0) {\n              $list.html('<p class=\"cfr2-empty\">No pending items in queue.</p>');\n              return;\n            }\n\n            let html = '<table class=\"cfr2-pending-table\"><thead><tr>' +\n              '<th>File</th><th>Action</th><th>Status</th><th></th>' +\n              '</tr></thead><tbody>';\n\n            items.forEach((item) => {\n              const statusClass = item.status === 'processing' ? 'cfr2-status-processing' : 'cfr2-status-pending';\n              const canCancel = item.status === 'pending';\n              const safeId = parseInt(item.id, 10) || 0;\n\n              html += `<tr data-id=\"${safeId}\">\n                <td class=\"cfr2-pending-filename\">${this.escapeHtml(item.filename)}</td>\n                <td><span class=\"cfr2-action-badge\">${this.escapeHtml(item.action)}</span></td>\n                <td><span class=\"${statusClass}\">${this.escapeHtml(item.status)}</span></td>\n                <td>${canCancel ? `<button type=\"button\" class=\"button button-small cfr2-cancel-pending-item\" data-id=\"${safeId}\">Cancel</button>` : '<span class=\"cfr2-processing-indicator\">●</span>'}</td>\n              </tr>`;\n            });\n\n            html += '</tbody></table>';\n            $list.html(html);\n          } else {\n            $list.html('<p class=\"cfr2-error\">Failed to load pending items.</p>');\n          }\n        },\n        error: () => {\n          $list.html('<p class=\"cfr2-error\">Failed to load pending items.</p>');\n        },\n      });\n    },\n\n    /**\n     * Handle cancel single pending item.\n     *\n     * @param {Event} e Click event.\n     */\n    handleCancelPendingItem(e) {\n      e.preventDefault();\n\n      const $btn = $(e.currentTarget);\n      const itemId = $btn.data('id');\n      const $row = $btn.closest('tr');\n\n      $btn.prop('disabled', true).text('Cancelling...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_cancel_pending_item',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n          item_id: itemId,\n        },\n        success: (response) => {\n          if (response.success) {\n            $row.fadeOut(300, () => {\n              $row.remove();\n              // Check if table is empty.\n              if ($('#cfr2-pending-list tbody tr').length === 0) {\n                $('#cfr2-pending-list').html('<p class=\"cfr2-empty\">No pending items in queue.</p>');\n              }\n            });\n            this.showToast(response.data.message, 'success');\n            this.updatePendingStat();\n          } else {\n            this.showToast(response.data.message, 'error');\n            $btn.prop('disabled', false).text('Cancel');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to cancel item', 'error');\n          $btn.prop('disabled', false).text('Cancel');\n        },\n      });\n    },\n\n    /**\n     * Handle clear all pending items.\n     *\n     * @param {Event} e Click event.\n     */\n    handleClearPending(e) {\n      e.preventDefault();\n\n      if (!confirm('Cancel all pending items? This will not affect items currently being processed.')) {\n        return;\n      }\n\n      const $btn = $(e.currentTarget);\n      $btn.prop('disabled', true).text('Clearing...');\n\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_clear_pending',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success) {\n            this.showToast(response.data.message, 'success');\n            this.loadPendingItems();\n            this.updatePendingStat();\n          } else {\n            this.showToast(response.data.message, 'error');\n          }\n        },\n        error: () => {\n          this.showToast('Failed to clear pending items', 'error');\n        },\n        complete: () => {\n          $btn.prop('disabled', false).text('Clear All');\n        },\n      });\n    },\n\n    /**\n     * Update pending stat count.\n     */\n    updatePendingStat() {\n      $.ajax({\n        url: myPluginAdmin.ajaxUrl,\n        type: 'POST',\n        data: {\n          action: 'cfr2_get_bulk_counts',\n          nonce: $('#cloudflare_r2_offload_cdn_nonce').val(),\n        },\n        success: (response) => {\n          if (response.success && typeof response.data.pending !== 'undefined') {\n            const pendingCount = response.data.pending;\n            const $stat = $('#cfr2-pending-stat');\n            $stat.find('.cfr2-stat-value').text(pendingCount.toLocaleString());\n\n            // Update clickable state.\n            if (pendingCount > 0) {\n              $stat.addClass('cfr2-stat-clickable');\n              $stat.find('.dashicons').show();\n            } else {\n              $stat.removeClass('cfr2-stat-clickable');\n              $stat.find('.dashicons').hide();\n            }\n          }\n        },\n      });\n    },\n  };\n\n  // Initialize when DOM ready.\n  $(document).ready(() => {\n    CFR2OffLoadAdmin.init();\n  });\n})(jQuery);\n"],"names":["$","CFR2OffLoadAdmin","e","$tab","tabId","$header","$content","formData","response","isLoading","message","type","icon","$toast","$btn","$result","actionText","data","$offloadBtn","$restoreBtn","$deleteLocalBtn","ajaxActions","actionTexts","ajaxAction","logType","completed","failed","total","processed","percentage","elapsed","minutes","seconds","$terminal","time","$line","text","div","isEnabled","value","entry","attachmentId","nonce","$status","cdnUrl","zoneId","recordId","$list","items","html","item","statusClass","canCancel","safeId","itemId","$row","pendingCount","$stat"],"mappings":"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"}